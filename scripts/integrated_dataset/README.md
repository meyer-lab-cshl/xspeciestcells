This directory contains scripts related to analyses performed from the integrated dataset (i.e. corresponding to UMAP presented in Fig 1 of manuscript). Code in R markdowns was knitted into html files for users to see code output.

| Script | Description | Manuscript Figure(s) |
| ------ | ----------- | -------------------- |
| [06_DEanalysis_pbmc_btw_Tlineages.R](06_DEanalysis_pbmc_btw_Tlineages.R) | pseudobulk DE analysis between peripheral blood T cell lineages, to search for lineage-specific genes (SCRIPT STILL BEING CLEANED UP BY TONYA/LAURENT) | Fig 4E, 4F |
| [DE_analysis_btw_thymocytes.Rmd](DE_analysis_btw_thymocytes.Rmd) | pseudobulk DE analysis between thymocyte lineages | Fig 2B, 2C |
| [metaneighbor_btw_thymic_lineages.Rmd](metaneighbor_btw_thymic_lineages.Rmd) | gene expression similarity analysis between thymocyte lineages | Fig 2A |
| [pymtn_park_01_prepare_data.Rmd](./pymtn_park_01_prepare_data.Rmd) | creates a unique `.h5ad` file containing thymocytes data from both our dataset and the [Park et al.](https://www.science.org/doi/10.1126/science.aay3224) dataset, and a list of common HVGs saved in a `.csv` file, both needed to run MetaNeighbor; these files will be stored in the [data_github/park_dataset/pymtn/](../../data_github/park_dataset/pymtn/) directory when the user runs the script (i.e. these files were not uploaded to this github repo) | necessary for [pymtn_park_02_run_metaneighbor.py](./pymtn_park_02_run_metaneighbor.py) |
| [pymtn_park_02_run_metaneighbor.ipynb](./pymtn_park_02_run_metaneighbor.ipynb) | :warning: to run **only if you do not have access to a HPC and can't run [pymtn_park_02_run_metaneighbor.py](./pymtn_park_02_run_metaneighbor.py)**, this jupyter notebook allows to run a **fast version** of MetaNeighbor on your local computer :warning: ; generates the `.csv` file [human_thym_merged_with_park_pymtn_fast_version_output_240902.csv](../../data_github/park_dataset/pymtn/human_thym_merged_with_park_pymtn_fast_version_output_240902.csv) | if output is used in [pymtn_park_03_plot_metaneighbor.Rmd](./pymtn_park_03_plot_metaneighbor.Rmd), it will generate a plot very close (but not identical) to Supplementary Fig 4B |
| [pymtn_park_02_run_metaneighbor.py](./pymtn_park_02_run_metaneighbor.py) | run **slow version** of MetaNeighbor between our dataset and the Human Thymus Atlas from [Park et al.](https://www.science.org/doi/10.1126/science.aay3224) with the [pyMN](https://github.com/gillislab/pyMN) package; this **slow version** of MetaNeighbor allows to reproduce Supplementary Fig 4B but needs to be run on a HPC (if you can only use your local computer, you can run the **fast version** with the `.ipynb` file); generates the `.csv` file [human_thym_merged_with_park_pymtn_slow_version_output_240902.csv](../../data_github/park_dataset/pymtn/human_thym_merged_with_park_pymtn_slow_version_output_240902.csv) | necessary for [pymtn_park_03_plot_metaneighbor.Rmd](./pymtn_park_03_plot_metaneighbor.Rmd) to reproduce Supplementary Fig 4B |
| [pymtn_park_03_plot_metaneighbor.Rmd](./pymtn_park_03_plot_metaneighbor.Rmd) | plot gene expression similarity analysis between our dataset and the [Park et al.](https://www.science.org/doi/10.1126/science.aay3224) dataset | Supplementary Fig 4A & B |



